kind: test
name: places
spec:
  steps:
    - title: Given the Amaragua
      steps:
        - Given details for the Amaragua
        - When I create that place
        - Then I should have a 201
    - title: Given the Auditorium
      steps:
        - Given details for the Auditorium
        - When I create that place
        - Then I should have a 201
    - title: Given I am in Torremolinos
      location:
        lat: 36.606657
        lon: -4.5118278
    - title: Given I am in Madrid
      location:
        lat: 40.4439799
        lon: -3.6652171
    - title: Given a fake place
      place:
        id: "unknown"
    - title: Given details for the Amaragua
      place:
        id: d3c175e6
        name: Amaragua
        lat: 36.6078731
        lon: -4.5063965
    - title: Given details for the Auditorium
      place:
        id: 55b0e3ab
        name: Auditorium
        lat: 40.4483318
        lon: -3.5609397
    - title: When I create that place
      http:
        method: post
        url:
          - @baseUrl
          - /api/places
        headers:
          content-type: application/json
          authorization: @token
        body: @place
      as: latest
    - title: When I get that place
      http:
        method: get
        url:
          - @baseUrl
          - /api/places/
          - @place.id
        headers:
          authorization: @token
      as: latest
    - title: Then I should have that place
      expect:
        body:
          id: @place.id
      in: @latest
