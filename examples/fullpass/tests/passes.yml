kind: test
name: passes
spec:
  init:
    currency: EUR
  steps:
    - title: Given 50 euros
      price: 50
    - title: Given 40 euros
      price: 40
    - title: Given 65 euros
      price: 65
    - title: Given a lady full pass
      steps:
        - Given details for a lady full pass
        - When I create that pass
        - Then I should have a 201
    - title: Given a men full pass
      steps:
        - Given details for a men full pass
        - When I create that pass
        - Then I should have a 201
    - title: Given details for a lady full pass
      pass:
        id:
          uuid: {}
        event: @event.id
        kind: fullpass
        genre: women
    - title: Given details for a men full pass
      pass:
        id:
          uuid: {}
        event: @event.id
        kind: fullpass
        genre: men
    - title: When I create that pass
      http:
        method: post
        url:
          - @baseUrl
          - /api/assets
        headers:
          content-type: application/json
          client-id: mobile
          client-secret: @clients.mobile
          authorization: @token
        body: @pass
      as: latest
    - title: When I get all passes for that event
      http:
        method: get
        url:
          - @baseUrl
          - /api/assets
        headers:
          client-id: mobile
          client-secret: @clients.mobile
          authorization: @token
        query:
          event: @event.id
      as: latest
