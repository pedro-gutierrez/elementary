kind: test
name: password
spec:
  steps:
    - title: Given I forgot my password
      steps:
        - When I forgot my password
        - Then I should have a 201
        - Then I should have a token
    - title: Given I resetted my password
      steps:
        - Given I forgot my password
        - Given password foo
        - When I reset my password
        - Then I should have a 201
    - title: When I forgot my password
      http:
        method: post
        url:
          - @baseUrl
          - /api/passwd/forgot
        headers:
          content-type: application/json
        body:
          email: @user.email
      as: latest
    - title: When I reset my password
      http:
        method: post
        url:
          - @baseUrl
          - /api/passwd/reset
        headers:
          authorization: @token
          content-type: application/json
        body:
          email: @user.email
          password: @password
      as: latest
    - title: Then I should have a token
      token: @latest.body.token
    - title: Given password foo
      password: foo
    - title: Given password bar
      password: bar
