kind: module
name: client_id
spec:
  decoders:
    http:
      allowed:
        headers:
          with_pair:
            - client-id
            - client-secret
          in: @clients
      forbidden:
        headers:
          any: object
  update:
    allowed:
      model: {}
    forbidden:
      cmds:
        stop: unauthorized
  encoders:
    unauthorized:
      status: 401
      headers:
        content-type: application/json
      body: {}
