kind: module
name: create_package
spec:
  decoders:
    http:
      create:
        body:
          id:
            any: text
          name:
            any: text
          time:
            any: number
          rate:
            any: number
  update:
    create:
      model:
        package: @data.body
      cmds:
        store: create
  encoders:
    create:
      store: @store
      insert:
        merge:
          - @package
          - created:
              now: {}
            organization: @organization.id
            timeLeft: @package.time
            owner: @user.id
      into: packages
