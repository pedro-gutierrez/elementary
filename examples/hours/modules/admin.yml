kind: module
name: admin
spec:
  decoders:
    http:
      admin:
        headers:
          authorization: @admin
      user:
        headers:
          authorization:
            other_than: @admin
      anonymous:
        headers:
          without:
            - authorization
  update:
    user:
      cmds:
        stop: unauthorized
    anonymous:
      cmds:
        stop: unauthorized
    admin:
      model: {}
  encoders:
    unauthorized:
      status: 401
      headers:
        content-type: application/json
      body: {}
