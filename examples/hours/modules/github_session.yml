kind: module
name: github_session
spec:
  decoders:
    http:
      create_session:
        params:
          stage: session
  update:
    create_session:
      model:
        session:
          uuid: {}
      cmds:
        return: authorize
  encoders:
    authorize:
      status: 302
      headers:
        location:
          encoder: github_auth_url
    github_auth_url:
      uri: "https://github.com/login/oauth/authorize"
      with:
        client_id: "@client"
        state: "@session"
        redirect_uri:
          format: "{{ baseUrl }}{{ redirectPath }}"
