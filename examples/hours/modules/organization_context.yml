kind: module
name: organization_context
spec:
  decoders:
    http:
      find:
        params:
          id:
            any: text
    store:
      not_found:
        organization: not_found
  update:
    find:
      model:
        organization: @data.params.id
      cmds:
        store: find_organization
    organization:
      model:
        organization: @data.organization
      cmds:
        store: find_user_memberships
    user_memberships:
      model:
        user_memberships: @data.user_memberships
    not_found:
      cmd:
        return: not_found
