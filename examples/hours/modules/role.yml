kind: module
name: role
spec:
  decoders:
    http:
      allowed:
        headers:
          with_pair:
            - api-key
            - api-secret
          in: @roles
      forbidden:
        headers:
          any: object
  update:
    allowed:
      model: {}
    forbidden:
      cmds:
        stop: unauthorized
  encoders:
    unauthorized:
      status: 401
      headers:
        content-type: application/json
      body: {}
