kind: module
name: ui_landing
spec:
  init:
    cmds:
      ui: landing-layout-view
  decoders:
    ui:
      show-landing:
        show: landing
  update:
    show-landing:
      cmds:
        ui: landing-layout-view

  encoders:
    landing-layout-view:
      tag: div
      children:
        - view: container-view
          params:
            content-view: landing-view
            content: "@"
        - view: footer-view
    landing-view:
      tag: section
      attrs:
        class: section
      children:
        - view: landing-title-view
        - view: social-login-view
        - view: features-view
          params:
            features:
              - title: Plan
                summary: Describe your work, and organize your projects with a simple and minimal user interface
              - title: Collaborate
                summary: Delegate, communicate with others. Keep conversations efficient and focused.
              - title: Track
                summary: Allocate resources, control cost, stay on top of things, and deliver on time
    landing-title-view:
      view: hero-view
      params:
        icon: ""
        title: Timeboxed
        subtitle: Simple tasks. Stay focused.
    social-login-view:
      tag: div
      attrs:
        class: has-text-centered
      children:
        - view: social-button-view
          params:
            url: /api/google/session
            label: Sign in with Google
            icon: fab fa-google
        - view: social-button-view
          params:
            url: /api/github/session
            label: Sign in with Github 
            icon: fab fa-github
        - view: social-button-view
          params:
            url: /api/facebook/session
            label: Sign in with Facebook 
            icon: fab fa-facebook-square
        - view: social-button-view
          params:
            url: /api/linkedin/session
            label: Sign in with LinkedIn 
            icon: fab fa-linkedin-in
    social-button-view:
      tag: a 
      attrs:
        class: button is-rounded is-primary is-medium
        href: "@url"
        style:
          border-radius: 50%
          margin-left: 5px
          margin-right: 5px
          padding: 25px
      children:
        - view: icon-view
    features-view:
      tag: section
      attrs:
        class: is-medium section
      children:
        - tag: div
          attrs:
            class: columns
          children:
            loop: "@features"
            with: feature-view
    feature-view:
      tag: div
      attrs:
        class: has-text-centered column
      children:
        - tag: h5
          attrs:
            class: has-text-primary is-size-5
          children:
            - "@title"
        - tag: p
          children:
            - "@summary"
    login-view:
      view: form-view
      params:
        name: login
        status: invalid
        message: ""
        fields:
          - name: email
            kind: email
            placeholder: you@domain.com
          - name: password
            kind: password
            placeholder: Your password
        actions:
          - name: submit
            label: Login
        related:
          - name: forgot-password
            label: Forgot password?
          - name: register
            label: Don't have an account?
    form-view:
      tag: div
      children:
        - tag: div
          attrs:
            class: box
          children:
            - view: form-message-view
              when:
                match:
                  status:
                    other_than: loading
                  message:
                    non_empty: text
            - tag: div
              children:
                concat:
                loop: 
                  concat:
                    - "@fields"
                    - kind: actions
                      actions: "@actions"
                with: form-field-view
                params:
                  status: "@status"
                  form-name: "@name"
        - tag: div
          children:
            loop: "@related"
            with: internal-link-view
    form-message-view:
      tag: div
      attrs:
        class: 
          format: notification is-{{ style }}
          params:
            style:
              encoder: form-message-style
      children:
        - "@message"
    form-message-style:
      switch: "@status"
      case:
        error: danger
      default: warning
    form-field-view:
      tag: div
      attrs:
        class: field
      children:
        - view:
            format: "form-{{ kind }}-view"
    form-email-view:
      view: form-input-view
    form-password-view:
      view: form-input-view
    form-input-view:
      tag: div
      children:
        - tag: label
          attrs:
            class: label
          children:
            - encoder: form-field-title
        - tag: div
          attrs:
            class: control
          children:
            - tag: input
              attrs:
                let:
                  disabled:
                    encoder: form-input-disabled-style
                in:
                  merge:
                    - "@disabled"
                    - class: input
                      type: "@kind"
                      placeholder: "@placeholder"
                      oninput:
                        format: "{{ form-name }}-{{ name }}"
    form-actions-view:
      tag: div
      attrs:
        class: control
      children:
        loop: "@actions"
        with: form-submit-button
    form-field-title:
      resolve:
        - label 
      otherwise:
        capitalize: "@name"
    form-submit-button:
      tag: button
      attrs:
        class: 
          format: button is-link is-{{ status }}
        onclick:
          format: "{{ form-name }}-{{ name}}"
        style:
          margin-right: 5px
      children:
        - encoder: form-field-title
    form-input-disabled-style: 
      switch: "@status"
      case:
        loading:
          disabled: ""
      default: {}

