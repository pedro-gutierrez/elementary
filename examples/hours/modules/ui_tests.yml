kind: module
name: ui_tests
spec:
  init:
    model:
      tests: []
    cmds:
      http: get-tests
  decoders:
    http:
      tests:
        tests:
          status: 200
          body:
            any: list
  update:
    tests:
      model:
        tests: @data.tests.body
      cmds:
        ui: {}
  encoders:
    get-tests:
      method: get
      path: /tests.json
      as: tests
    tests-view:
      tag: div
      children:
        loop: @tests
        with: scenario-item-view
    scenario-item-view:
      tag: div
      attrs:
        class: box
      children:
        - tag: h5
          attrs:
            class: title is-5
          children:
            - @title
        - tag: div
          attrs:
            class: subtitle
          children:
            - view: tags-view
              params:
                tags:
                  - label: @status
                    color: success
                  - label:
                      format: "{{ time }}ms"
                    color: light
        - view: steps-view
    steps-view:
      tag: div
      children:
        loop: @steps
        with: step-item-view
    step-item-view:
      tag: div
      children:
        - @title
    tags-view:
      tag: div
      attrs:
        class: tags
      children:
        loop: @tags
        with: tag-view
    tag-view:
      tag: span
      attrs:
        class:
          format: "tag is-{{color}}"
      children:
        - capitalize: @label
