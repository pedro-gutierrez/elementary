kind: module
name: package_time
spec:
  decoders:
    store:
      package_time:
        package_time:
          first:
            with:
              timeLogged:
                any: number
          otherwise:
            timeLogged: 0
  encoders:
    package_time:
      store: @store
      aggregate:
        - $match:
            package: @package.id
        - $group:
            _id: $package
            timeLogged:
              $sum: $time
      from: time
      as: package_time
