kind: test
name: packages
spec:
  steps:
    - title: Given details for package 50h
      package:
        id:
          uuid: {}
        name: 50h
        totalTime: 50
        rate: 36
    - title: Given details for package 60h
      package:
        id:
          uuid: {}
        name: 60h
        totalTime: 60
        rate: 24
    - title: Given package 50h
      steps:
        - Given details for package 50h
        - When I add that package to that organization
        - Then I should have a 201
    - title: Given package 60h
      steps:
        - Given details for package 60h
        - When I add that package to that organization
        - Then I should have a 201
    - title: When I add that package to that organization
      http:
        method: post
        url:
          - @baseUrl
          - /api/organizations/
          - @organization.id
          - /packages
        headers:
          merge:
            - @json
            - @auth
        body: @package
      as: latest
    - title: When I get all packages in that organization
      http:
        method: get
        url:
          - @baseUrl
          - /api/organizations/
          - @organization.id
          - /packages
        headers: @auth
      as: latest
    - title: When I get that package
      http:
        method: get
        url:
          - @baseUrl
          - /api/packages/
          - @package.id
        headers: @auth
      as: latest
    - title: When I get all packages in that project
      http:
        method: get
        url:
          - @baseUrl
          - /api/projects/
          - @project.id
          - /packages
        headers: @auth
      as: latest
