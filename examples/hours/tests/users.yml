kind: test
name: users
spec:
  steps:
    - title: Given details for alice
      user:
        object:
          id:
            uuid: {}
          first: Alice
          last: Cooper
          email: alice@foo.bar
    - title: Given user alice
      steps:
        - Given details for alice
        - When I create that user
        - Then I should have a 201
    - title: When I create that user
      http:
        method: post
        url:
          - @baseUrl
          - /api/users
        headers:
          content-type: application/json
          api-key: @client.key
          api-secret: @client.secret
        body: @user
      as: latest
    - title: When I get all users
      http:
        method: get
        url:
          - @baseUrl
          - /api/users
        headers:
          api-key: @client.key
          api-secret: @client.secret
      as: latest
