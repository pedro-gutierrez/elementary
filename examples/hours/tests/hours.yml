kind: test
name: hours
spec:
  include:
    - http
    - store
    - health
    - roles
    - packages
    - users
    - projects
    - assignments
  init:
    baseUrl:
      url: @hours
  scenarios:
    - title: Should have a healtcheck
      steps:
        - When I get the health
        - Then I should have a 200
    - title: Employer shoud create packages
      steps:
        - Given the store is empty
        - Given I am an employer
        - Given package 50h
        - When I create that package
        - Then I should have a 409
        - When I get all packages
        - Then I should have a 200
        - Then I should have one item
        - When I get that package
        - Then I should have a 200
    - title: Employer should create users
      steps:
        - Given the store is empty
        - Given I am an employer
        - Given user alice
        - When I create that user
        - Then I should have a 409
        - When I get all users
        - Then I should have a 200
        - Then I should have one item
        - When I get that user
        - Then I should have a 200
    - title: Employer should create projects
      steps:
        - Given the store is empty
        - Given I am an employer
        - Given project iot
        - When I create that project
        - Then I should have a 409
        - When I get all projects
        - Then I should have a 200
        - Then I should have one item
        - When I get that project
        - Then I should have a 200
    - title: Employer should assign packages to projects
      steps:
        - Given the store is empty
        - Given I am an employer
        - Given project iot
        - Given package 50h
        - Given that package is assigned to that project
        - When I assign that package to that project
        - Then I should have a 409
        - When I get all assignments for that project
        - Then I should have a 200
        - Then I should have one item
    - title: Employer should assign users to projects
      tags:
        - debug
      steps:
        - Given the store is empty
        - Given I am an employer
        - Given project iot
        - Given user alice
        - Given that user is assigned to that project
        - When I assign that user to that project
        - Then I should have a 409
        - When I get all assignments for that project
        - Then I should have a 200
        - Then I should have one item
