kind: module
name: signup
spec:
  decoders:
    uuid:
      token:
        uuid:
          any: text
    entity:
      success:
        status: ok
  update:
    created:
      model: @
      cmds:
        uuid: {}
    token:
      model:
        uuid: @uuid
      cmds:
        entity: signup
    success:
      cmds:
        return: token
  encoders:
    signup:
      create:
        token:
          id: @uuid
          version: 1
          value: @uuid
          acl: passwd:reset
          user: @uuid
        user:
          id: @uuid
          version: 1
          username: @username
      in: @store
    token:
      token: @uuid
