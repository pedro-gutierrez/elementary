kind: module
name: index
spec:
  decoders:
    http:
      index:
        any: object
  update:
    index:
      model:
        let:
          mode:
            maybe: "@data.query.mode"
            otherwise: dark
          theme:
            maybe: "@data.query.theme"
            otherwise: pink 
        in:
          displayMode: "@mode"
          theme: "@theme"
          bodyStyle:
            switch: "@mode"
            case:
              dark: "text-gray-500 bg-gray-900"
            default: "text-gray-700"
      cmds:
        return: index
  encoders:
    index:
      status: 200
      headers:
        content-type: "text/html; charset=utf-8"
        expires: 0
        cache-control: no-cache, no-store, must-revalidate
      body:
        format: |
          <!DOCTYPE html>
            <html>
              <head>
                <meta charset="utf-8" />
                <meta name="viewport" content="width=device-width, initial-scale=1">
                <title>{{title}}</title>
                <link rel="stylesheet" href="css/tailwind.min.css"/>
                <link rel="stylesheet" href="css/fa.min.css"/>
                <script src="js/mustache.min.js"></script>
                <script src="js/elementary-dom.js"></script>
                <script src="js/moment.min.js"></script>
                <script type="module">
                  import {default as ui} from "/js/elementary-ui.js";
                  import {default as events} from "/js/elementary-events.js";
                  import {default as http} from "/js/elementary-http.js";
                  import {default as router} from "/js/elementary-router.js";
                  import {default as app} from "/js/elementary.js";
                  app("/js/app.js", {ui, events, http, router}, {Mustache, moment}, {
                    displayMode: "{{displayMode}}", 
                    theme: "{{theme}}"
                  })
                </script>
              </head>
              <body class="{{bodyStyle}}">
              </body>
            </html>
