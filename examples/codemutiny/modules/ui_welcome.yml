kind: module
name: ui_welcome
spec:
  decoders:
    http:
      unauthorized:
        status: 401
      profile:
        body:
          email:
            any: text
          id:
            any: text
          name:
            any: text
          picture:
            any: text
    ui:
      menu-status:
        set-menu-status:
          any: text
  update:
    welcome-page:
      model:
        view: loading-view
        session: "@data.query.session"
        onProfile:
          ui: member-layout-view
      cmds:
        http: get-profile
        ui: empty-layout-view
    unauthorized:
      model:
        session: ""
        view: unauthorized-view
      cmds:
        ui: {}
    profile:
      model:
        profile: "@data.body"
        view: dashboard-view
      cmds: "@onProfile"
    menu-status:
      model:
        menuStatus: "@data.set-menu-status"
      cmds:
        ui: {}
  encoders:
    get-profile:
      method: get
      path: /api/profile
      headers:
        authorization: "@session"
