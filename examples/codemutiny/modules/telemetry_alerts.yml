kind: module
name: telemetry_alerts
spec:
  decoders:
    caller:
      alert:
        app:
          any: text
        duration:
          greaterThan: 100
        status:
          any: text
      ignore:
        duration:
          not:
            greaterThan: 100
  update:
    ignore:
      model: {}
    alert:
      model:
        alert: "@data"
      cmds:
        slack: alert
  encoders:
    alert:
      object:
        channel: telemetry
        text:
          format: "App *{{ app }}* took *{{ duration }}ms* and returned *{{ status }}*"
          params: "@alert"
