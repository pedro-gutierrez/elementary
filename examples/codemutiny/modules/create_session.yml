kind: module
name: create_session
spec:
  decoders:
    caller:
      create_session: 
        session:
          identity:
            any: text
    store:
      session_created: 
        session: "created"
  update:
    create_session:
      model:
        kind: "session"
        token:
          id:
            uuid: {}
          session:
            now: {}
      cmds:
        store: create_session
    session_created:
      cmds:
        stop: created
  encoders:
    create_session:
      store: "@store"
      insert: "@token"
      into: tokens
