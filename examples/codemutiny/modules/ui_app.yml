kind: module
name: ui_app
spec:
  init:
    model:
      member-view-nav: []
  decoders:
    events:
      subscribed-products-ready:
        subscribed-products:
          any: list
  update:
    subscribed-products-ready:
      model:
        view: 
          encoder: member-first-view
        member-view-nav:
          map: "@model.subscribed-products"
          with: 
            encoder: product-nav-item
      cmds:
        ui: member-layout-view
  encoders:
    product-nav-item:
      route: "@item.name"
      title:
        capitalize: "@item.name"
    member-first-view:
      let:
        app:
          maybe: "@app"
          otherwise:
            let:
              product: 
                head: "@model.subscribed-products"
            in: "@product.name"
      in:
        format: "{{ app }}-view"