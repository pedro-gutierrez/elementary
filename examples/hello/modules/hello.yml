kind: module
name: hello
spec:
  init:
    model:
      foo: foo
      message: @apiServer
      sabor: @flavour
      headers:
        dict:
          content-type: application/json
  decoders:
    default:
      get:
        method: GET
        headers:
          content-type:
            any: text
      simple:
        method: GET
      post:
        dict:
          method: POST
          headers:
            any: dict
          body:
            message:
              any: text
    store:
      not_found:
        dict:
          rows:
            empty: list
  update:
    simple:
      cmds:
        response: simple
    post:
      model:
        message: @body.message
        kind:
          a:
            b:
              c: @headers.content-type
        items:
          - key: body
      cmds:
        response: hello
    get:
      model:
        message: dummy
        kind:
          a:
            b:
              c: @headers.content-type
        plap: plop
        items:
          - item1
          - item2
          - 1
          - true
        num: 1
        is_valid: true
      cmds:
        response: hello
  encoders:
    simple:
      status: 200
      headers:
        content-type: application/json
      body: @
    hello:
      status: 201
      headers:
        content-type: application/json
      body:
        all: @
        message: @message
        items: @items
        kind: @kind.a.b.c
